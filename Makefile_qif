CFLAGS=-std=c++11 -O3 -Wall -Wextra -Werror -pedantic

all: qifd.bc distributiond.bc channeld.bc gaind.bc hyperd.bc vulnerabilityd.bc entropyd.bc leakaged.bc binary

qifd.bc:
	em++ -c ./src/qif.cpp $(CFLAGS) -o qif.bc

distributiond.bc:
	em++ -c ./src/distribution.cpp $(CFLAGS) -o distribution.bc

channeld.bc:
	em++ -c ./src/channel.cpp $(CFLAGS) -o channel.bc

gaind.bc:
	em++ -c ./src/gain.cpp $(CFLAGS) -o gain.bc

hyperd.bc:
	em++ -c ./src/hyper.cpp $(CFLAGS) -o hyper.bc

vulnerabilityd.bc:
	em++ -c ./src/vulnerability.cpp $(CFLAGS) -o vulnerability.bc

entropyd.bc:
	em++ -c ./src/entropy.cpp $(CFLAGS) -o entropy.bc

leakaged.bc:
	em++ -c ./src/leakage.cpp $(CFLAGS) -o leakage.bc

binary:
	emar rcs qif.a distribution.bc channel.bc gain.bc hyper.bc vulnerability.bc entropy.bc leakage.bc
	rm -r -f bin
	mkdir bin
	mv *.bc ./bin/

clean:
	rm -rf bin/*.bc
	rm -rf qif.a